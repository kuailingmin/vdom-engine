/*!
 * vdom-engine.js v0.1.6
 * (c) 2016 Jade Gu
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Vengine=n()}(this,function(){"use strict";function e(e,n){le[e]=n}function n(e){delete le[e]}function t(e){var n=e.match(ue);return n?(de=n[2],le[n[1]]):void 0}function r(e,n,r){var o=t(n);o&&o.attach(e,de,r)}function o(e,n){var r=t(n);r&&r.detach(e,de)}function a(e,n){for(var t in n)"children"!==t&&null!=n[t]&&r(e,t,n[t])}function i(e,n,t){for(var a in n)if("children"!==a){var i=t[a];i!==n[a]&&(null==i?o(e,a):r(e,a,i))}for(var a in t)"children"!==a&&(a in n||r(e,a,t[a]))}function c(e){return"function"==typeof e}function l(){}function u(e){return e}function d(e,n){return function(){return e.apply(this,arguments),n.apply(this,arguments)}}function f(e,n,t){for(var r=e.length,o=-1;r--;){var a=e[++o];we(a)?f(a,n,t):n(a,t)}}function v(e,n){e[e.length]=n}function p(e,n){if(!n)return e;for(var t=Object.keys(n),r=t.length;r--;)e[t[r]]=n[t[r]];return e}function s(){return++Ee}function h(e,n){return e+n.charAt(0).toUpperCase()+n.substring(1)}function y(e,n){var t=e.type,r=e.props,o=t(r,n);if(o&&o.render&&(o=o.render()),null===o||o===!1)o={vtype:VCOMMENT,uid:_.getUid()};else if(!o||!o.vtype)throw new Error("@"+t.name+"#render:You may have returned undefined, an array or some other invalid object");return o}function m(e,n){var t={},r=null;if(null!=n)for(var o in n)"key"===o?void 0!==n.key&&(r=""+n.key):t[o]=n[o];var a=e.defaultProps;if(a)for(var o in a)void 0===t[o]&&(t[o]=a[o]);var i=arguments.length,c=Ne;if(i>2){c=[];for(var l=2;i>l;l++){var u=arguments[l];we(u)?f(u,b,c):b(u,c)}}t.children=c;var d=null;if("string"==typeof e)d=pe;else{if("function"!=typeof e)throw new Error("unexpect type [ "+e+" ]");d=se}var v={vtype:d,type:e,props:t,key:r};return d===se&&(v.uid=s()),v}function g(e){return null!=e&&!!e.vtype}function x(e){var n=function(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return m.apply(void 0,[e].concat(t))};return n.type=e,n}function b(e,n){null!=e&&"boolean"!=typeof e&&(n[n.length]=e.vtype?e:""+e)}function k(e,n,t){e[n]=t}function N(e,n){e[n]=""}function w(e,n,t){e.setAttribute(n,t+"")}function E(e,n){e.removeAttribute(n)}function C(e,n,t){I(e.style,n,t)}function U(e,n){e.style[n]=""}function I(e,n,t){!_.isUnitlessNumber[n]&&_.RE_NUMBER.test(t)?t+="px":null!=t&&"boolean"!=typeof t||(t=""),"float"===n&&(n="cssFloat"),e[n]=t}function O(e,n){e.eventStore=null;for(var t in n)0===t.indexOf("on-")&&(t=A(t),je[t]&&(e[t]=null))}function A(e){return e.replace(/^on-/,"on").toLowerCase()}function S(e,n,t){if(n="on"+n,1===je[n])return void(e[n]=t);var r=e.eventStore||(e.eventStore={});r[n]=t,ze[n]||(document.addEventListener(n.substr(2),j,!1),ze[n]=!0),Me&&n===Pe&&e.addEventListener("click",Ve,!1);var o=e.nodeName;"onchange"!==n||"INPUT"!==o&&"TEXTAREA"!==o||S(e,"oninput",t)}function T(e,n){if(n="on"+n,1===je[n])return void(e[n]=null);var t=e.eventStore||(e.eventStore={});delete t[n],Me&&n===Pe&&e.removeEventListener("click",Ve,!1);var r=e.nodeName;"onchange"!==n||"INPUT"!==r&&"TEXTAREA"!==r||delete t.oninput}function j(e){for(var n=e.target,t=e.type,r="on"+t,o=null;n;){var a=n,i=a.eventStore,c=i&&i[r];if(c){if(o||(o=R(e)),o.currentTarget=n,c.call(n,o),o.$cancalBubble)break;n=n.parentNode}else n=n.parentNode}}function R(e){var n={},t=function(){return n.$cancalBubble=!0};n.nativeEvent=e,n.persist=l;for(var r in e)"function"!=typeof e[r]?n[r]=e[r]:"stopPropagation"===r||"stopImmediatePropagation"===r?n[r]=t:n[r]=e[r].bind(e);return n}function M(e,n,t){var r=e.vtype,o=null;return r?r===pe?o=F(e,n,t):r===se?o=X(e,n,t):r===he&&(o=document.createComment("react-empty: "+e.uid)):o=document.createTextNode(e),o}function V(e,n,t,r){var o=e.vtype;return o===se?Y(e,n,t,r):o!==pe?t:(null!=e.props[ye]?(G(e,n,t,r),W(n,t,r)):(P(e,n,t,r),G(e,n,t,r)),t)}function P(e,n,t,r){var o={removes:[],updates:[],creates:[]};$(o,e,n,t,r),f(o.removes,B),f(o.updates,z),f(o.creates,L)}function z(e){if(e){var n=e.node;if(e.shouldUpdate){var t=e.vnode,r=e.newVnode,o=e.context;t.vtype?t.vtype===pe?G(t,r,n,o):t.vtype===se&&(n=Y(t,r,n,o)):n.nodeValue=r}if(e.index!==e.fromIndex){var a=n.parentNode.childNodes[index];a!==n&&n.parentNode.insertBefore(n,a)}}}function B(e){D(e.vnode,e.node),e.node.parentNode.removeChild(e.node)}function L(e){var n=e.parentNode,t=n.childNodes[e.index],r=M(e.vnode,e.context,n.namespaceURI);n.insertBefore(r,t)}function D(e,n){var t=e.vtype;t===pe?H(e,n):t===se&&q(e,n)}function F(e,n,t){var r=e.type,o=e.props,i=null;return"svg"===r||t===fe?(i=document.createElementNS(fe,r),t=fe):i=document.createElement(r),W(i,o.children,n),a(i,o),o[me]&&o[me].call(null,i,o),o[ge]&&v(Be,{type:ge,node:i,props:o}),i}function W(e,n,t){for(var r=e.namespaceURI,o=0,a=n.length;a>o;o++)e.appendChild(M(n[o],t,r))}function $(e,n,t,r,o){var a=r.childNodes,i=n.props.children,c=t.props.children,l=i.length,u=c.length;if(0!==l)if(0!==u){for(var d={},f=Array(u),p=null,s=null,h=0;l>h;h++)for(var y=i[h],m=0;u>m;m++)if(!f[m]){var g=c[m];if(y===g){var x=!1;o&&y.vtype===se&&y.type.length>1&&(x=!0),f[m]={shouldUpdate:x,vnode:y,newVnode:g,node:a[h],context:o,index:m,fromIndex:h},d[h]=!0;break}}for(var h=0;l>h;h++)if(!d[h]){for(var b=i[h],k=!0,m=0;u>m;m++)if(!f[m]){var N=c[m];if(N.type===b.type&&N.key===b.key){f[m]={shouldUpdate:!0,vnode:b,newVnode:N,node:a[h],context:o,index:m,fromIndex:h},k=!1;break}}k&&(p||(p=[]),v(p,{vnode:b,node:a[h]}))}for(var h=0;u>h;h++){var w=f[h];w?w.vnode.vtype===pe&&$(e,w.vnode,w.newVnode,w.node,w.context):(s||(s=[]),v(s,{vnode:c[h],parentNode:r,context:o,index:h}))}p&&v(e.removes,p),s&&v(e.creates,s),v(e.updates,f)}else for(var h=0;l>h;h++)v(e.removes,{vnode:i[h],node:a[h]});else{if(0===u)return;for(var h=0;u>h;h++)v(e.creates,{vnode:c[h],parentNode:r,context:o,index:h})}}function G(e,n,t){var r=n.props;return r[xe]&&r[xe].call(null,t,r),i(t,e.props,r),r[be]&&r[be].call(null,t,r),t}function H(e,n){for(var t=e.props,r=t.children,o=n.childNodes,a=0,i=r.length;i>a;a++)D(r[a],o[a]);c(t[ke])&&t[ke].call(null,n,t),O(n,t)}function X(e,n,t){var r=y(e,n),o=M(r,n,t);return o.cache=o.cache||{},o.cache[e.uid]=r,o}function Y(e,n,t,r){var o=e.uid,a=t.cache[o];delete t.cache[o];var i=y(n,r),c=J(a,i,t,r);return c.cache=c.cache||{},c.cache[n.uid]=i,c!==t&&p(c.cache,t.cache),c}function q(e,n){var t=e.uid,r=n.cache[t];delete n.cache[t],D(r,n)}function J(e,n,t,r){var o=t;return null==n?(D(e,t),t.parentNode.removeChild(t)):e.type!==n.type||e.key!==n.key?(D(e,t),o=M(n,r,t.namespaceURI),t.parentNode.replaceChild(o,t)):(e!==n||r)&&(o=V(e,n,t,r)),o}function K(n,t,r,o){if(!n.vtype)throw new Error("cannot render "+n+" to container");e("attr",Se),e("prop",Ae),e("on",Re),e("css",Te);var a=t[ve]||(t[ve]=s()),i=De[a];if(c(r)&&(o=r,r=void 0),i)return void(i===!0?De[a]={vnode:n,context:r,callback:o}:(i.vnode=n,i.context=r,o&&(i.callback=i.callback?d(i.callback,o):o)));if(De[a]=!0,Fe.hasOwnProperty(a))J(Fe[a],n,t.firstChild,r);else{for(var l=M(n,r,t.namespaceURI),u=null;u=t.lastChild;)t.removeChild(u);t.appendChild(l)}Fe[a]=n,Le(),i=De[a],De[a]=null,"object"==typeof i&&K(i.vnode,t,i.context,i.callback),o&&o()}function Q(e){if(!e.nodeName)throw new Error("expect node");var n=e[ve],t=null;return(t=Fe[n])?(D(t,e.firstChild),e.removeChild(e.firstChild),delete Fe[n],delete De[n],!0):!1}function Z(e,n,t){v(e.attrs,n+'="'+t+'"')}function ee(e,n,t){!Ce[styleName]&&Ie.test(t)?t+="px":null!=t&&"boolean"!=typeof t||(t=""),t&&v(e.style,n+":"+t+";")}function ne(n,t){return e("attr",$e),e("css",_e),te(n,t)}function te(e,n){var t=e.vtype,r="";return t?t===pe?r=re(e,n):t===se&&(r=ie(e,n)):r=e,r}function re(e,n){var t={tagName:e.type,children:e.props.children,attrs:[],style:[]};return a(t,e.props),oe(t)}function oe(e,n){var t=e.tagName,r=(e.attrs,e.style,e.children),o=ce(e),a=Ge[t];return a?"<"+t+o+" />":"<"+t+o+">"+ae(r,n)+"</"+t+">"}function ae(e,n){for(var t=[],r=0,o=e.length;o>r;r++)v(t,te(e[r],n));return t.join("")}function ie(e,n){var t=y(e,n),r=te(t,n);return r}function ce(e){var n=e.attrs,t=e.style;return t.length&&v(n,'style="'+t.join("")+'"'),n.length?" "+n.join(" "):""}var le={},ue=/^([^-]+)-(.+)$/,de=null,fe="http://www.w3.org/2000/svg",ve="liteid",pe=1,se=2,he=3,ye="prop-innerHTML",me="hook-willMount",ge="hook-didMount",xe="hook-willUpdate",be="hook-didUpdate",ke="hook-willUnmount",Ne=[],we=Array.isArray,Ee=0,Ce={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridColumn:1,fontWeight:1,lineClamp:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Ue=["Webkit","ms","Moz","O"];Object.keys(Ce).forEach(function(e){Ue.forEach(function(n){Ce[h(n,e)]=1})});var Ie=/^-?\d+(\.\d+)?$/;Object.freeze||(Object.freeze=u);var Oe={h:m,createElement:m,createFactory:x,isValidElement:g,addDirective:e,removeDirective:n},Ae={attach:k,detach:N},Se={attach:w,detach:E},Te={attach:C,detach:U},je={onmouseleave:1,onmouseenter:1,onload:1,onunload:1,onscroll:1,onfocus:1,onblur:1,onrowexit:1,onbeforeunload:1,onstop:1,ondragdrop:1,ondragenter:1,ondragexit:1,ondraggesture:1,ondragover:1,oncontextmenu:1},Re={attach:S,detach:T},Me="ontouchstart"in document,Ve=function(){},Pe="onclick",ze={},Be=[],Le=function(){var e=Be.length;if(e){for(var n=Be,t=-1;e--;){var r=n[++t];r.props[r.type].call(null,r.node,r.props)}Be.length=0}},De={},Fe={},We={render:K,destroy:Q},$e={attach:Z},_e={attach:ee},Ge={area:1,base:1,br:1,col:1,command:1,embed:1,hr:1,img:1,input:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1},He={renderToString:ne},Xe={};return p(Xe,Oe),p(Xe,We),p(Xe,He),Xe});