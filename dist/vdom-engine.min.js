/*!
 * vdom-engine.js v0.1.6
 * (c) 2016 Jade Gu
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("path-to-regexp"),require("querystring")):"function"==typeof define&&define.amd?define(["path-to-regexp","querystring"],n):e.Vengine=n(e.pathToRegexp,e.querystring)}(this,function(e,n){"use strict";function t(e){return"function"==typeof e}function r(e){return null!=e&&t(e.then)}function o(e){return e()}function a(){}function c(e){return e}function u(e,n){return function(){return e.apply(this,arguments),n.apply(this,arguments)}}function l(e,n,t){for(var r=e.length,o=-1;r--;){var a=e[++o];be(a)?l(a,n,t):n(a,t)}}function f(e,n){e[e.length]=n}function d(e,n){if(!n)return e;for(var t=Object.keys(n),r=t.length;r--;)e[t[r]]=n[t[r]];return e}function s(){return++xe}function p(e,n){return e+n.charAt(0).toUpperCase()+n.substring(1)}function v(e,n){var t=e.type,r=e.props,o=t(r,n);if(o&&o.render&&(o=o.render()),null===o||o===!1)o={vtype:VCOMMENT,uid:_.getUid()};else if(!o||!o.vtype)throw new Error("@"+t.name+"#render:You may have returned undefined, an array or some other invalid object");return o}function h(e){function n(e){a[e]=Oe()}function t(e,n,t,r){var i=new Date,c=i.getHours()+":"+Ce(i.getMinutes())+":"+Ce(i.getSeconds()),u=(Oe()-a[e]).toFixed(2),l=o+"-"+(t===r?"equal":"diff")+": action ["+e+"] end at "+c+", take "+u+"ms";try{console.groupCollapsed(l)}catch(f){try{console.group(l)}catch(f){console.log(l)}}if("log"===Ne)console[Ne](n),console[Ne](t),console[Ne](r);else{var d=r instanceof Error;console[Ne]("%c data","color: #03A9F4; font-weight: bold",n),console[Ne]("%c prev state","color: #9E9E9E; font-weight: bold",t),console[Ne]("%c "+(d?"error":"next state"),"color: #4CAF50; font-weight: bold",r)}try{console.groupEnd()}catch(f){console.log("-- log end --")}}var r=e.name,o=void 0===r?"store":r,a={};return{start:n,end:t}}function y(e){function n(e){var n=g.indexOf(e);return-1===n&&g.push(e),function(){var n=g.indexOf(e);-1!==n&&g.splice(i,1)}}function a(){return m}function c(e,n){return m=e,n||g.forEach(o),m}function u(e,n){var o=d[e];if(!t(o))throw new Error("Expected a function which is "+o);var a=o(m,n);return r(a)?a.then(c):(m!==a&&c(a),m)}function l(e,n){var r=f[e];if(!t(r))throw new Error("Expected a function which is "+r);var o=r(m,n);return o}var f=e.getter,d=e.setter,s=e.name,p=e.debug,v=e.initialState,y=null;p!==!1&&(y=h(s));var m=v,g=[],b={getState:a,replaceState:c,search:l,dispatch:u,subscribe:n};return d&&(b.actions=Object.keys(d).reduce(function(e,n){var t=0;return e[n]=function(e){var o=n+"*"+t++,a=m,i=m,c=function(n){y&&y.end(o,e,a,n)};y&&y.start(o);try{i=u(n,e)}catch(l){return c(l),i}return r(i)?i.then(c,c):(c(i),i)},e},{})),f&&(b.selectors=Object.keys(f).reduce(function(e,n){return e[n]=l.bind(null,n),e})),b}function m(n,t,r){var o=[],a=e(n,o),i=a.exec(t);if(!i)return!1;for(var c=1,u=i.length;u>c;c++){var l=o[c-1];l&&("string"==typeof i[c]?r[l.name]=decodeURIComponent(i[c]):r[l.name]=i[c])}return!0}function g(e){return"?"===e[0]?e.substr(1):e}function b(e){return e.replace(/\/\//g,"/")}function x(e,n){Ie[e]=n}function k(e){delete Ie[e]}function w(e){var n=e.match(Se);return n?(Ae=n[2],Ie[n[1]]):void 0}function E(e,n,t){var r=w(n);r&&r.attach(e,Ae,t)}function N(e,n){var t=w(n);t&&t.detach(e,Ae)}function C(e,n){for(var t in n)"children"!==t&&null!=n[t]&&E(e,t,n[t])}function O(e,n,t){for(var r in n)if("children"!==r){var o=t[r];o!==n[r]&&(null==o?N(e,r):E(e,r,o))}for(var r in t)"children"!==r&&(r in n||E(e,r,t[r]))}function U(e,n){var t={},r=null;if(null!=n)for(var o in n)"key"===o?void 0!==n.key&&(r=""+n.key):t[o]=n[o];var a=e.defaultProps;if(a)for(var o in a)void 0===t[o]&&(t[o]=a[o]);var i=arguments.length,c=ge;if(i>2){c=[];for(var u=2;i>u;u++){var f=arguments[u];be(f)?l(f,A,c):A(f,c)}}t.children=c;var d=null;if("string"==typeof e)d=Re;else{if("function"!=typeof e)throw new Error("unexpect type [ "+e+" ]");d=Me}var p={vtype:d,type:e,props:t,key:r};return d===Me&&(p.uid=s()),p}function I(e){return null!=e&&!!e.vtype}function S(e){var n=function(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return U.apply(void 0,[e].concat(t))};return n.type=e,n}function A(e,n){null!=e&&"boolean"!=typeof e&&(n[n.length]=e.vtype?e:""+e)}function T(e,n,t){e[n]=t}function j(e,n){e[n]=""}function R(e,n,t){e.setAttribute(n,t+"")}function M(e,n){e.removeAttribute(n)}function V(e,n,t){F(e.style,n,t)}function q(e,n){e.style[n]=""}function F(e,n,t){!_.isUnitlessNumber[n]&&_.RE_NUMBER.test(t)?t+="px":null!=t&&"boolean"!=typeof t||(t=""),"float"===n&&(n="cssFloat"),e[n]=t}function P(e,n){e.eventStore=null;for(var t in n)0===t.indexOf("on-")&&(t=z(t),Ge[t]&&(e[t]=null))}function z(e){return e.replace(/^on-/,"on").toLowerCase()}function D(e,n,t){if(n="on"+n,1===Ge[n])return void(e[n]=t);var r=e.eventStore||(e.eventStore={});r[n]=t,Ke[n]||(document.addEventListener(n.substr(2),L,!1),Ke[n]=!0),Xe&&n===Je&&e.addEventListener("click",Ye,!1);var o=e.nodeName;"onchange"!==n||"INPUT"!==o&&"TEXTAREA"!==o||D(e,"oninput",t)}function B(e,n){if(n="on"+n,1===Ge[n])return void(e[n]=null);var t=e.eventStore||(e.eventStore={});delete t[n],Xe&&n===Je&&e.removeEventListener("click",Ye,!1);var r=e.nodeName;"onchange"!==n||"INPUT"!==r&&"TEXTAREA"!==r||delete t.oninput}function L(e){for(var n=e.target,t=e.type,r="on"+t,o=null;n;){var a=n,i=a.eventStore,c=i&&i[r];if(c){if(o||(o=W(e)),o.currentTarget=n,c.call(n,o),o.$cancalBubble)break;n=n.parentNode}else n=n.parentNode}}function W(e){var n={},t=function(){return n.$cancalBubble=!0};n.nativeEvent=e,n.persist=a;for(var r in e)"function"!=typeof e[r]?n[r]=e[r]:"stopPropagation"===r||"stopImmediatePropagation"===r?n[r]=t:n[r]=e[r].bind(e);return n}function $(e,n,t){var r=e.vtype,o=null;return r?r===Re?o=Q(e,n,t):r===Me?o=re(e,n,t):r===Ve&&(o=document.createComment("react-empty: "+e.uid)):o=document.createTextNode(e),o}function G(e,n,t,r){var o=e.vtype;return o===Me?oe(e,n,t,r):o!==Re?t:(null!=e.props[qe]?(ne(e,n,t,r),Z(n,t,r)):(H(e,n,t,r),ne(e,n,t,r)),t)}function H(e,n,t,r){var o={removes:[],updates:[],creates:[]};ee(o,e,n,t,r),l(o.removes,Y),l(o.updates,X),l(o.creates,J)}function X(e){if(e){var n=e.node;if(e.shouldUpdate){var t=e.vnode,r=e.newVnode,o=e.context;t.vtype?t.vtype===Re?ne(t,r,n,o):t.vtype===Me&&(n=oe(t,r,n,o)):n.nodeValue=r}if(e.index!==e.fromIndex){var a=n.parentNode.childNodes[index];a!==n&&n.parentNode.insertBefore(n,a)}}}function Y(e){K(e.vnode,e.node),e.node.parentNode.removeChild(e.node)}function J(e){var n=e.parentNode,t=n.childNodes[e.index],r=$(e.vnode,e.context,n.namespaceURI);n.insertBefore(r,t)}function K(e,n){var t=e.vtype;t===Re?te(e,n):t===Me&&ae(e,n)}function Q(e,n,t){var r=e.type,o=e.props,a=null;return"svg"===r||t===Te?(a=document.createElementNS(Te,r),t=Te):a=document.createElement(r),Z(a,o.children,n),C(a,o),o[Fe]&&o[Fe].call(null,a,o),o[Pe]&&f(Qe,{type:Pe,node:a,props:o}),a}function Z(e,n,t){for(var r=e.namespaceURI,o=0,a=n.length;a>o;o++)e.appendChild($(n[o],t,r))}function ee(e,n,t,r,o){var a=r.childNodes,i=n.props.children,c=t.props.children,u=i.length,l=c.length;if(0!==u)if(0!==l){for(var d={},s=Array(l),p=null,v=null,h=0;u>h;h++)for(var y=i[h],m=0;l>m;m++)if(!s[m]){var g=c[m];if(y===g){var b=!1;o&&y.vtype===Me&&y.type.length>1&&(b=!0),s[m]={shouldUpdate:b,vnode:y,newVnode:g,node:a[h],context:o,index:m,fromIndex:h},d[h]=!0;break}}for(var h=0;u>h;h++)if(!d[h]){for(var x=i[h],k=!0,m=0;l>m;m++)if(!s[m]){var w=c[m];if(w.type===x.type&&w.key===x.key){s[m]={shouldUpdate:!0,vnode:x,newVnode:w,node:a[h],context:o,index:m,fromIndex:h},k=!1;break}}k&&(p||(p=[]),f(p,{vnode:x,node:a[h]}))}for(var h=0;l>h;h++){var E=s[h];E?E.vnode.vtype===Re&&ee(e,E.vnode,E.newVnode,E.node,E.context):(v||(v=[]),f(v,{vnode:c[h],parentNode:r,context:o,index:h}))}p&&f(e.removes,p),v&&f(e.creates,v),f(e.updates,s)}else for(var h=0;u>h;h++)f(e.removes,{vnode:i[h],node:a[h]});else{if(0===l)return;for(var h=0;l>h;h++)f(e.creates,{vnode:c[h],parentNode:r,context:o,index:h})}}function ne(e,n,t){var r=n.props;return r[ze]&&r[ze].call(null,t,r),O(t,e.props,r),r[De]&&r[De].call(null,t,r),t}function te(e,n){for(var r=e.props,o=r.children,a=n.childNodes,i=0,c=o.length;c>i;i++)K(o[i],a[i]);t(r[Be])&&r[Be].call(null,n,r),P(n,r)}function re(e,n,t){var r=v(e,n),o=$(r,n,t);return o.cache=o.cache||{},o.cache[e.uid]=r,o}function oe(e,n,t,r){var o=e.uid,a=t.cache[o];delete t.cache[o];var i=v(n,r),c=ie(a,i,t,r);return c.cache=c.cache||{},c.cache[n.uid]=i,c!==t&&d(c.cache,t.cache),c}function ae(e,n){var t=e.uid,r=n.cache[t];delete n.cache[t],K(r,n)}function ie(e,n,t,r){var o=t;return null==n?(K(e,t),t.parentNode.removeChild(t)):e.type!==n.type||e.key!==n.key?(K(e,t),o=$(n,r,t.namespaceURI),t.parentNode.replaceChild(o,t)):(e!==n||r)&&(o=G(e,n,t,r)),o}function ce(e,n,r,o){if(!e.vtype)throw new Error("cannot render "+e+" to container");x("attr",$e),x("prop",We),x("on",He),x("css",_e);var a=n[je]||(n[je]=s()),i=en[a];if(t(r)&&(o=r,r=void 0),i)return void(i===!0?en[a]={vnode:e,context:r,callback:o}:(i.vnode=e,i.context=r,o&&(i.callback=i.callback?u(i.callback,o):o)));if(en[a]=!0,nn.hasOwnProperty(a))ie(nn[a],e,n.firstChild,r);else{for(var c=$(e,r,n.namespaceURI),l=null;l=n.lastChild;)n.removeChild(l);n.appendChild(c)}nn[a]=e,Ze(),i=en[a],en[a]=null,"object"==typeof i&&ce(i.vnode,n,i.context,i.callback),o&&o()}function ue(e){if(!e.nodeName)throw new Error("expect node");var n=e[je],t=null;return(t=nn[n])?(K(t,e.firstChild),e.removeChild(e.firstChild),delete nn[n],delete en[n],!0):!1}function le(e,n,t){f(e.attrs,n+'="'+t+'"')}function fe(e,n,t){!ke[styleName]&&Ee.test(t)?t+="px":null!=t&&"boolean"!=typeof t||(t=""),t&&f(e.style,n+":"+t+";")}function de(e,n){return x("attr",rn),x("css",on),se(e,n)}function se(e,n){var t=e.vtype,r="";return t?t===Re?r=pe(e,n):t===Me&&(r=ye(e,n)):r=e,r}function pe(e,n){var t={tagName:e.type,children:e.props.children,attrs:[],style:[]};return C(t,e.props),ve(t)}function ve(e,n){var t=e.tagName,r=(e.attrs,e.style,e.children),o=me(e),a=an[t];return a?"<"+t+o+" />":"<"+t+o+">"+he(r,n)+"</"+t+">"}function he(e,n){for(var t=[],r=0,o=e.length;o>r;r++)f(t,se(e[r],n));return t.join("")}function ye(e,n){var t=v(e,n),r=se(t,n);return r}function me(e){var n=e.attrs,t=e.style;return t.length&&f(n,'style="'+t.join("")+'"'),n.length?" "+n.join(" "):""}e="default"in e?e["default"]:e,n="default"in n?n["default"]:n;var ge=[],be=Array.isArray,xe=0,ke={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridColumn:1,fontWeight:1,lineClamp:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},we=["Webkit","ms","Moz","O"];Object.keys(ke).forEach(function(e){we.forEach(function(n){ke[p(n,e)]=1})});var Ee=/^-?\d+(\.\d+)?$/;Object.freeze||(Object.freeze=c);var Ne="info"in console?"info":"log",Ce=function(e){return("0"+e).slice(-2)},Oe="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return(new Date).getTime()},Ue=function(e){return function(r,o){var a=d({},r),i=b(a.pathname),c=g(a.search),u=a.params={};a.query=n.parse(c);for(var l in e){var f=m(l,i,u),s=e[l];if(f&&t(s)){s(u,o);break}}return a}},Ie={},Se=/^([^-]+)-(.+)$/,Ae=null,Te="http://www.w3.org/2000/svg",je="liteid",Re=1,Me=2,Ve=3,qe="prop-innerHTML",Fe="hook-willMount",Pe="hook-didMount",ze="hook-willUpdate",De="hook-didUpdate",Be="hook-willUnmount",Le={h:U,createElement:U,createFactory:S,isValidElement:I,addDirective:x,removeDirective:k,createMatcher:Ue,createStore:y},We={attach:T,detach:j},$e={attach:R,detach:M},_e={attach:V,detach:q},Ge={onmouseleave:1,onmouseenter:1,onload:1,onunload:1,onscroll:1,onfocus:1,onblur:1,onrowexit:1,onbeforeunload:1,onstop:1,ondragdrop:1,ondragenter:1,ondragexit:1,ondraggesture:1,ondragover:1,oncontextmenu:1},He={attach:D,detach:B},Xe="ontouchstart"in document,Ye=function(){},Je="onclick",Ke={},Qe=[],Ze=function(){var e=Qe.length;if(e){for(var n=Qe,t=-1;e--;){var r=n[++t];r.props[r.type].call(null,r.node,r.props)}Qe.length=0}},en={},nn={},tn={render:ce,destroy:ue},rn={attach:le},on={attach:fe},an={area:1,base:1,br:1,col:1,command:1,embed:1,hr:1,img:1,input:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1},cn={renderToString:de},un={};return d(un,Le),d(un,tn),d(un,cn),un});